<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CoolVoce ‚ù§Ô∏èüíö</title>
  <style>
    :root{
      --green:#00b25c;
      --red:#b30000;
      --muted-border: #dcdcdc;
      --bg-start:#fff8f8;
      --bg-end:#f3fff3;
    }

    html,body{height:100%;margin:0;font-family:'Segoe UI', system-ui, -apple-system, "Helvetica Neue", Arial; background: linear-gradient(135deg,var(--bg-start),var(--bg-end)); -webkit-font-smoothing:antialiased;}
    .container{max-width:1200px;margin:0 auto;padding:20px;box-sizing:border-box;}

    /* logo */
    .logo{display:flex;align-items:center;justify-content:center;gap:12px;margin-bottom:18px}
    .logo-shape{width:42px;height:42px;border-radius:10px;background:linear-gradient(145deg,var(--red),var(--green));transform:rotate(-10deg);box-shadow:0 3px 8px rgba(0,0,0,.12)}
    .logo-text{font-weight:700;color:var(--red);font-size:1.9rem}
    .hearts{font-size:1.5rem;margin-left:6px}

    /* grid controls */
    .controls-grid{
      display:grid;
      grid-template-columns: repeat(4, minmax(220px, 1fr));
      gap:12px;
      align-items:end;
      margin-bottom:12px;
    }
    .control{display:flex;flex-direction:column}
    label{font-weight:700;margin-bottom:6px;font-size:.95rem}

    select, input[type="text"], button{
      height:48px;
      padding:0 14px;
      font-size:1.05rem;
      border-radius:10px;
      border:1px solid var(--muted-border);
      box-shadow:0 4px 10px rgba(0,0,0,.06);
      background:#fff;
      box-sizing:border-box;
    }
    input::placeholder{color:#bdbdbd}

    /* GENERA row spans full width of the grid */
    .generate-row{grid-column:1 / -1}
    #generateBtn{
      width:100%;
      border:none;
      color:#fff;
      font-weight:800;
      cursor:pointer;
      border-radius:10px;
      background: linear-gradient(90deg,var(--green) 0%, var(--red) 100%);
      background-size:200% 100%;
      transition: background-position .45s ease, transform .12s ease, box-shadow .12s ease;
      box-shadow: 0 6px 14px rgba(0,0,0,0.08);
    }
    #generateBtn:hover{ background-position:100% 0; transform: translateY(-3px); box-shadow: 0 10px 24px rgba(0,0,0,0.12); }
    #generateBtn.copied{ animation: pulse .5s ease-in-out; background: linear-gradient(90deg,#28a745,#ff6b6b) !important }
    @keyframes pulse{ 0%{ transform:scale(1)} 50%{ transform:scale(1.04)} 100%{ transform:scale(1)} }

    /* description (under the button) */
    .offer-description{ display:none; margin:12px 0; padding:12px 14px; border-left:4px solid var(--red); background:#fff6f6; border-radius:8px; color:#222; font-size:.98rem; max-width:100% }

    /* links container */
    #linksContainer{
      margin-top:10px;
      background:#f9fff9;
      border:2px solid rgba(0,178,92,0.14);
      border-radius:10px;
      padding:10px;
      min-height:220px;
      max-height:60vh;
      overflow:auto;
      box-sizing:border-box;
    }

    .link-box{
      background:#fff;
      border-radius:8px;
      padding:12px;
      margin-bottom:10px;
      box-shadow:0 4px 10px rgba(0,0,0,.06);
      word-break:break-all;
      display:flex;
      flex-direction:column;
      gap:8px;
      transition: transform .12s ease, box-shadow .12s ease;
    }
    .link-box a{ color:var(--green); font-weight:700; text-decoration:none }
    .link-box a:hover{ text-decoration:underline }

    /* actions row */
    .link-actions{ display:flex; gap:8px; justify-content:flex-end }
    .link-actions button{
      padding:6px 10px;
      border-radius:8px;
      border:1px solid var(--muted-border);
      background:#fff;
      cursor:pointer;
      font-weight:700;
      box-shadow:0 2px 6px rgba(0,0,0,.04);
    }
    .link-actions button.open-btn{ color:#fff; background: linear-gradient(90deg,var(--green),#1fb96a); border:none }
    .link-actions button.copy-btn{ color:#fff; background: linear-gradient(90deg,var(--red),#ff6b6b); border:none }

    /* latest link border + animation */
    .link-box.latest{
      border:2px solid var(--green);
      background: linear-gradient(180deg,#ffffff,#f7fff7);
      animation: lastPulse .75s ease;
    }
    @keyframes lastPulse{
      0%{ box-shadow: 0 0 0 0 rgba(0,178,92,0.35); transform: translateY(-4px) }
      40%{ box-shadow: 0 8px 20px rgba(0,178,92,0.12); transform: translateY(0) }
      100%{ box-shadow: 0 6px 14px rgba(0,0,0,0.06); transform: translateY(0) }
    }

    @media (max-width:820px){
      .controls-grid{ grid-template-columns: repeat(2, minmax(160px, 1fr)); }
      .generate-row{ grid-column:1 / -1; }
    }
    @media (max-width:520px){
      .controls-grid{ grid-template-columns: 1fr; gap:10px }
      #generateBtn{ height:48px }
    }
  </style>
</head>
<body>
  <div class="container" role="main">
    <div class="logo" aria-hidden="true">
      <div class="logo-shape"></div>
      <div class="logo-text">CoolVoce</div>
      <div class="hearts">‚ù§Ô∏èüíö</div>
    </div>

    <div class="controls-grid" aria-label="Controlli generatore">
      <div class="control">
        <label for="offerSelect">OFFERTA?</label>
        <select id="offerSelect" aria-label="Offerta">
          <option value="">SELEZIONA</option>
          <option value="EVO20_MNPANN">EVO20_MNPANN</option>
          <option value="EVO50_MNPGRT2">EVO50_MNPGRT2</option>
          <option value="EVO150_MNPGRT5">EVO150_MNPGRT5</option>
          <option value="EVO200_MNPGRT7">EVO200_MNPGRT7</option>
          <option value="EXT300MNPGRT5">EXT300MNPGRT5</option>
          <option value="EXT300MNPGRT4">EXT300MNPGRT4</option>
          <option value="EVOUNMNPATGRT">EVOUNMNPATGRT</option>
        </select>
      </div>

      <div class="control">
        <label for="customOffer">CODICE?</label>
        <input id="customOffer" type="text" placeholder="PERSONALIZZATO" aria-label="Codice personalizzato" />
      </div>

      <div class="control">
        <label for="simType">SIM?</label>
        <select id="simType" aria-label="Tipo SIM">
          <option value="SPEDIZIONE">SIM</option>
          <option value="ESIM">eSIM</option>
        </select>
      </div>

      <div class="control">
        <label for="activationType">ATTIVAZIONE?</label>
        <select id="activationType" aria-label="Attivazione">
          <option value="1">NUOVA</option>
          <option value="2">MNP</option>
        </select>
      </div>

      <!-- GENERA spans full width -->
      <div class="generate-row">
        <button id="generateBtn" type="button">GENERA</button>
      </div>
    </div>

    <div id="offerDescription" class="offer-description" aria-live="polite"></div>
    <div id="linksContainer" aria-live="polite"></div>
  </div>

  <script>
    (function(){
      const offers = {
        "EVO20_MNPANN": { desc: "üì± Minuti illimitati, 1000 SMS e 20GB in 4G+<br>üí∞ 29.90‚Ç¨ primo anno, poi 4.90‚Ç¨/mese<br>üìÜ Scaduta nel: 06/2025" },
        "EVO50_MNPGRT2": { desc: "üì± Minuti illimitati, 1000 SMS e 50GB in 4G+<br>üí∞ 4.90‚Ç¨/mese<br>üìÜ Scaduta nel: 12/2024" },
        "EVO150_MNPGRT5": { desc: "üì± Minuti illimitati, 1000 SMS e 150GB in 4G+<br>üí∞ 6.90‚Ç¨/mese<br>üìÜ Scaduta nel: 07/2025" },
        "EVO200_MNPGRT7": { desc: "üì± Minuti illimitati, 1000 SMS e 200GB in 4G+<br>üí∞ 7.90‚Ç¨/mese<br>üìÜ Scaduta nel: 12/2024" },
        "EXT300MNPGRT5": { desc: "üì± Minuti illimitati, 1000 SMS e 300GB in 4G+<br>üí∞ 7.90‚Ç¨/mese<br>üìÜ Scaduta nel: 06/2025" },
        "EXT300MNPGRT4": { desc: "üì± Minuti illimitati, 1000 SMS e 300GB in 4G+<br>üí∞ 9.90‚Ç¨/mese<br>üìÜ Scaduta nel: 03/2025" },
        "EVOUNMNPATGRT": { desc: "üì± Minuti illimitati, 1000 SMS e GB Illimitati (form. 500) in 4G+<br>üí∞ 9.90‚Ç¨/mese<br>üìÜ Scaduta nel: 11/2024" }
      };

      const qs = id => document.getElementById(id);
      const offerSelect = qs('offerSelect');
      const customInput = qs('customOffer');
      const simType = qs('simType');
      const activationType = qs('activationType');
      const generateBtn = qs('generateBtn');
      const offerDescription = qs('offerDescription');
      const linksContainer = qs('linksContainer');

      function hideDescription(){ offerDescription.style.display='none'; offerDescription.innerHTML=''; }
      function showDescription(text){ offerDescription.innerHTML=text; offerDescription.style.display='block'; }
      function clearLatest(){ const p = linksContainer.querySelector('.link-box.latest'); if(p) p.classList.remove('latest'); }

      async function copyText(t){
        try { await navigator.clipboard.writeText(t); return true; } catch(e){ return false; }
      }

      offerSelect.addEventListener('change', () => {
        const sel = offerSelect.value;
        if (sel){
          customInput.value = '';
          if (offers[sel]) showDescription(offers[sel].desc);
          else hideDescription();
        } else hideDescription();
      });

      customInput.addEventListener('input', () => {
        const v = customInput.value.trim();
        if (v){ offerSelect.value = ''; hideDescription(); }
        else if (offerSelect.value && offers[offerSelect.value]) showDescription(offers[offerSelect.value].desc);
      });

      generateBtn.addEventListener('click', async () => {
        const custom = customInput.value.trim();
        const selected = offerSelect.value.trim();
        const offerCode = custom || selected;

        // reset
        [customInput, offerSelect].forEach(el => el.style.boxShadow = '0 4px 10px rgba(0,0,0,0.06)');

        if (!offerCode) {
          [customInput, offerSelect].forEach(el => el.style.boxShadow = '0 0 0 4px rgba(211,47,47,0.12)');
          setTimeout(() => [customInput, offerSelect].forEach(el => el.style.boxShadow = '0 4px 10px rgba(0,0,0,0.06)'), 700);
          return;
        }

        const tipoFlusso = simType.value;
        const tipoAttivazione = activationType.value;
        const prefix = tipoFlusso === 'ESIM' ? 'ES_' : '';
        const rawCode = prefix + offerCode;
        const link = `https://shop.coopvoce.it/?tipoFlusso=${encodeURIComponent(tipoFlusso)}&tipoAttivazione=${encodeURIComponent(tipoAttivazione)}&codiceCampagna=${encodeURIComponent(rawCode)}`;

        clearLatest();
        const box = document.createElement('div');
        box.className = 'link-box latest';
        box.innerHTML = `
          <div class="link-main"><a href="${link}" target="_blank">${link}</a></div>
          <div class="link-actions">
            <button class="open-btn" type="button">APRI</button>
            <button class="copy-btn" type="button">COPIA</button>
          </div>
        `;
        linksContainer.prepend(box);

        await copyText(link);
        generateBtn.classList.add('copied');
        generateBtn.textContent = 'COPIATO!';
        setTimeout(() => { generateBtn.classList.remove('copied'); generateBtn.textContent = 'GENERA'; }, 1400);

        box.querySelector('.open-btn').addEventListener('click', () => window.open(link, '_blank'));
        box.querySelector('.copy-btn').addEventListener('click', async e => {
          await copyText(link);
          const btn = e.target; const old = btn.textContent;
          btn.textContent = 'Copiato!';
          setTimeout(() => btn.textContent = old, 1200);
        });
      });

      hideDescription();
    })();
  </script>
</body>
</html>
