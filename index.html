<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>CoolVoce ‚ù§Ô∏èüíö</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    html, body {
      height: 100%;
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    body {
      display: flex;
      flex-direction: column;
      padding: 20px;
      box-sizing: border-box;
      background: linear-gradient(135deg, #fff8f8, #f3fff3);
    }

    /* Logo CoolVoce */
    .logo {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin-bottom: 18px;
    }

    .logo-shape {
      width: 40px;
      height: 40px;
      background: linear-gradient(145deg, #b30000, #00b25c);
      border-radius: 10px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.12);
      transform: rotate(-10deg);
    }

    .logo-text {
      font-size: 2.2em;
      font-weight: 700;
      color: #b30000;
      letter-spacing: 0.6px;
    }

    .hearts {
      font-size: 1.7em;
      margin-left: 6px;
    }

    /* Controlli: riga allineata */
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: center;
      align-items: flex-end; /* allinea i campi in basso (label sopra) */
      max-width: 1200px;
      width: 100%;
      margin: 0 auto;
    }

    .controls .field {
      flex: 1 1 220px;
      display: flex;
      flex-direction: column;
      min-width: 150px;
    }

    label {
      font-weight: 700;
      font-size: 0.95em;
      margin-bottom: 6px;
      color: #111;
    }

    /* dimensione uniforme per input/select/button per evitare disallineamenti */
    input, select, button {
      font-size: 1.15em;
      padding: 12px 14px;
      border-radius: 8px;
      border: 1px solid #ccc;
      box-sizing: border-box;
      box-shadow: 0 4px 10px rgba(0,0,0,0.06);
      transition: transform 0.12s ease, box-shadow 0.12s ease;
      min-height: 48px;
      line-height: 1.1;
      background: #fff;
    }

    input::placeholder { color: #999; }

    input:focus, select:focus, button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 18px rgba(0,0,0,0.12);
      outline: none;
    }

    button {
      background-color: #00b25c;
      color: white;
      border: none;
      font-weight: 700;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      letter-spacing: 0.6px;
    }

    button.copied {
      background-color: #28a745 !important;
      animation: pulse 0.45s ease-in-out;
    }
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.06); }
      100% { transform: scale(1); }
    }

    /* Contenitore link */
    #linksContainer {
      flex: 1;
      display: flex;
      flex-direction: column-reverse;
      gap: 10px;
      max-width: 1200px;
      width: 100%;
      margin: 14px auto 30px auto;
      background: #f9fff9;
      border: 2px solid #00b25c22;
      border-radius: 10px;
      padding: 10px;
      min-height: 220px;
      overflow-y: auto;
    }

    .link-box {
      background: #ffffff;
      padding: 12px 14px;
      border-radius: 8px;
      font-size: 1.02em;
      word-break: break-all;
      box-shadow: 0 4px 10px rgba(0,0,0,0.06);
      border: 1px solid transparent;
      opacity: 0;
      transform: translateY(10px);
      animation: fadeInUp 0.35s ease forwards;
    }

    /* bordo speciale per l'ultimo link generato */
    .link-box.last {
      border: 2px solid #00b25c;
      box-shadow: 0 6px 16px rgba(0,178,92,0.10);
    }

    .link-box a {
      color: #008945;
      text-decoration: none;
      font-weight: 700;
    }
    .link-box a:hover { text-decoration: underline; }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Descrizione sotto il pulsante */
    #offerDescription {
      max-width: 1200px;
      margin: 14px auto 0 auto;
      background: #fff6f6;
      border-left: 4px solid #b30000;
      padding: 12px 14px;
      border-radius: 8px;
      display: none; /* mostrata quando c'√® selezione di offerta */
      font-size: 0.98em;
      color: #222;
    }

    /* Scrollbar */
    #linksContainer::-webkit-scrollbar { width: 8px; }
    #linksContainer::-webkit-scrollbar-thumb { background-color: #00b25c66; border-radius: 6px; }
    #linksContainer::-webkit-scrollbar-track { background-color: #e7f7ec; }

    @media (max-width: 900px) {
      .controls { gap: 10px; }
      .controls .field { flex: 1 1 180px; }
    }

    @media (max-width: 520px) {
      .controls { align-items: stretch; }
      .controls .field { min-width: 100%; }
      input, select, button { min-height: 46px; font-size: 1.02em; }
    }
  </style>
</head>
<body>
  <div class="logo">
    <div class="logo-shape" aria-hidden="true"></div>
    <div class="logo-text">CoolVoce</div>
    <div class="hearts">‚ù§Ô∏èüíö</div>
  </div>

  <div class="controls" role="group" aria-label="Generatore">
    <div class="field">
      <label for="offerSelect">OFFERTA?</label>
      <select id="offerSelect" aria-describedby="offerHelp">
        <option value="">SELEZIONA</option>
        <option value="EVO20_MNPANN">EVO20_MNPANN</option>
        <option value="EVO50_MNPGRT2">EVO50_MNPGRT2</option>
        <option value="EVO150_MNPGRT5">EVO150_MNPGRT5</option>
        <option value="EVO200_MNPGRT7">EVO200_MNPGRT7</option>
        <option value="EXT300MNPGRT5">EXT300MNPGRT5</option>
        <option value="EXT300MNPGRT4">EXT300MNPGRT4</option>
        <option value="EVOUNMNPATGRT">EVOUNMNPATGRT</option>
      </select>
    </div>

    <div class="field">
      <label for="customOffer">CODICE?</label>
      <input id="customOffer" type="text" placeholder="CODICE" autocomplete="off" />
    </div>

    <div class="field">
      <label for="simType">SIM?</label>
      <select id="simType">
        <option value="SPEDIZIONE">SIM</option>
        <option value="ESIM">eSIM</option>
      </select>
    </div>

    <div class="field">
      <label for="activationType">ATTIVAZIONE?</label>
      <select id="activationType">
        <option value="1">NUOVA</option>
        <option value="2">MNP</option>
      </select>
    </div>

    <div class="field" style="flex: 0 0 160px;">
      <!-- Pulsante allineato in basso grazie a align-items:flex-end sulla row -->
      <label style="visibility:hidden; height:0; margin:0; padding:0;">&nbsp;</label>
      <button id="generateBtn">GENERA</button>
    </div>
  </div>

  <!-- Descrizione posizionata sotto il pulsante GENERA (come richiesto) -->
  <div id="offerDescription" aria-live="polite"></div>

  <!-- Contenitore link -->
  <div id="linksContainer" aria-live="polite"></div>

  <script>
    const offers = {
      "EVO20_MNPANN": {
        desc: "üì± Minuti illimitati, 1000 SMS e 20GB in 4G+<br>üí∞ 29.90‚Ç¨ primo anno, poi 4.90‚Ç¨/mese<br>üìÜ Scaduta nel: 06/2025"
      },
      "EVO50_MNPGRT2": {
        desc: "üì± Minuti illimitati, 1000 SMS e 50GB in 4G+<br>üí∞ 4.90‚Ç¨/mese (nessun costo iniziale)<br>üìÜ Scaduta nel: 12/2024"
      },
      "EVO150_MNPGRT5": {
        desc: "üì± Minuti illimitati, 1000 SMS e 150GB in 4G+<br>üí∞ 6.90‚Ç¨/mese (nessun costo iniziale)<br>üìÜ Scaduta nel: 07/2025"
      },
      "EVO200_MNPGRT7": {
        desc: "üì± Minuti illimitati, 1000 SMS e 200GB in 4G+<br>üí∞ 7.90‚Ç¨/mese (nessun costo iniziale)<br>üìÜ Scaduta nel: 12/2024"
      },
      "EXT300MNPGRT5": {
        desc: "üì± Minuti illimitati, 1000 SMS e 300GB in 4G+<br>üí∞ 7.90‚Ç¨/mese (attivazione gratuita)<br>üìÜ Scaduta nel: 06/2025"
      },
      "EXT300MNPGRT4": {
        desc: "üì± Minuti illimitati, 1000 SMS e 300GB in 4G+<br>üí∞ 9.90‚Ç¨/mese (nessun costo iniziale)<br>üìÜ Scaduta nel: 03/2025"
      },
      "EVOUNMNPATGRT": {
        desc: "üì± Minuti illimitati, 1000 SMS e GB Illimitati (form. 500) in 4G+<br>üí∞ 9.90‚Ç¨/mese (attivazione gratuita)<br>üìÜ Scaduta nel: 11/2024"
      }
    };

    const offerSelect = document.getElementById('offerSelect');
    const customOffer = document.getElementById('customOffer');
    const offerDescription = document.getElementById('offerDescription');
    const generateBtn = document.getElementById('generateBtn');
    const linksContainer = document.getElementById('linksContainer');

    // Selezione offerta: svuota custom e mostra descrizione
    offerSelect.addEventListener('change', () => {
      const val = offerSelect.value;
      if (val && customOffer.value.trim() !== '') {
        // comportamento silenzioso: svuota l'input personalizzato se si seleziona una offerta
        customOffer.value = '';
      }
      if (offers[val]) {
        offerDescription.innerHTML = offers[val].desc;
        offerDescription.style.display = 'block';
      } else {
        offerDescription.style.display = 'none';
        offerDescription.innerHTML = '';
      }
    });

    // Digitazione codice personalizzato: svuota selezione offerta e nasconde descrizione
    customOffer.addEventListener('input', () => {
      const v = customOffer.value.trim();
      if (v !== '') {
        if (offerSelect.value !== '') {
          offerSelect.value = '';
        }
        offerDescription.style.display = 'none';
      } else {
        // se l'utente cancella tutto, lascia la descrizione nascosta finch√© non seleziona un'offerta
        offerDescription.style.display = 'none';
      }
    });

    // Genera link
    generateBtn.addEventListener('click', () => {
      const simType = document.getElementById('simType').value;
      const activationType = document.getElementById('activationType').value;
      const offerCode = (offerSelect.value || customOffer.value || '').trim();

      if (!offerCode) {
        // piccolo feedback visivo: pulsante scuote se manca il codice (non invasivo)
        generateBtn.animate([
          { transform: 'translateY(0)' },
          { transform: 'translateX(-6px)' },
          { transform: 'translateX(6px)' },
          { transform: 'translateY(0)' }
        ], { duration: 300, iterations: 1 });
        return;
      }

      const prefix = simType === 'ESIM' ? 'ES_' : '';
      const link = `https://shop.coopvoce.it/?tipoFlusso=${encodeURIComponent(simType)}&tipoAttivazione=${encodeURIComponent(activationType)}&codiceCampagna=${encodeURIComponent(prefix + offerCode)}`;

      // crea box link e lo aggiunge in cima
      const box = document.createElement('div');
      box.className = 'link-box';
      box.innerHTML = `<a href="${link}" target="_blank" rel="noopener noreferrer">${link}</a>`;

      // rimuove la classe 'last' dal precedente ultimo e la applica al nuovo
      const prevLast = linksContainer.querySelector('.link-box.last');
      if (prevLast) prevLast.classList.remove('last');
      box.classList.add('last');

      linksContainer.prepend(box);

      // copia negli appunti (navigator.clipboard preferito)
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(link).catch(() => {
          // fallback
          const t = document.createElement('input');
          document.body.appendChild(t);
          t.value = link;
          t.select();
          document.execCommand('copy');
          document.body.removeChild(t);
        });
      } else {
        const t = document.createElement('input');
        document.body.appendChild(t);
        t.value = link;
        t.select();
        document.execCommand('copy');
        document.body.removeChild(t);
      }

      // effetto copia sul pulsante
      generateBtn.textContent = 'COPIATO!';
      generateBtn.classList.add('copied');
      setTimeout(() => {
        generateBtn.textContent = 'GENERA';
        generateBtn.classList.remove('copied');
      }, 1500);

      // se volessi, qui potremmo auto-svuotare customOffer; per ora manteniamo il valore
    });
  </script>
</body>
</html>
